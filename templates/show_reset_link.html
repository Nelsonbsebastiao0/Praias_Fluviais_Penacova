{% extends "base.html" %}
{% block title %}Link de Recuperação{% endblock %}
{% block content %}
<div class="min-h-[80vh] flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
  <div class="max-w-2xl w-full">
    <div class="bg-white/60 backdrop-blur-lg rounded-2xl shadow-xl p-8 space-y-6 border border-gray-100">
      
      <!-- Ícone de Sucesso -->
      <div class="text-center space-y-3">
        <div class="mx-auto h-20 w-20 rounded-full bg-green-100 flex items-center justify-center">
          <i class="fas fa-check-circle text-4xl text-green-600"></i>
        </div>
        <h2 class="text-2xl font-bold text-gray-900">Link de Recuperação Gerado!</h2>
        <p class="text-sm text-gray-600">O email não foi enviado (modo desenvolvimento), mas você pode usar o link abaixo.</p>
      </div>

      <!-- Informação do Email -->
      <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
        <div class="flex items-start">
          <i class="fas fa-info-circle text-blue-600 mt-0.5 mr-3"></i>
          <div class="flex-1">
            <p class="text-sm text-blue-800 font-medium">Email de destino:</p>
            <p class="text-sm text-blue-900 font-semibold">{{ reset_email }}</p>
          </div>
        </div>
      </div>

      <!-- Link de Recuperação -->
      <div class="space-y-3">
        <label class="block text-sm font-medium text-gray-700">Link de recuperação (expira em 1 hora):</label>
        <div class="relative">
          <input 
            type="text" 
            id="resetLink" 
            value="{{ reset_link }}" 
            readonly 
            class="block w-full px-4 py-3 pr-24 rounded-lg border border-gray-300 bg-gray-50 text-sm font-mono text-gray-700 focus:ring-primary-500 focus:border-primary-500"
          />
          <button 
            onclick="copyLink()" 
            class="absolute right-2 top-1/2 -translate-y-1/2 px-4 py-1.5 bg-primary-600 text-white text-xs font-semibold rounded-md hover:bg-primary-700 transition-colors"
          >
            <i class="fas fa-copy mr-1"></i>Copiar
          </button>
        </div>
        <p class="text-xs text-gray-500">
          <i class="fas fa-clock mr-1"></i>
          Este link expira em 1 hora. Use-o apenas uma vez.
        </p>
      </div>

      <!-- Botão de Ação -->
      <div class="pt-4 space-y-3">
        <a 
          href="{{ reset_link }}" 
          class="w-full flex items-center justify-center py-3 px-4 rounded-lg text-sm font-semibold text-white bg-gradient-to-r from-primary-600 to-primary-500 hover:from-primary-700 hover:to-primary-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 shadow-lg shadow-primary-500/30 transition-all duration-200 transform hover:-translate-y-0.5"
        >
          <i class="fas fa-key mr-2"></i>
          Redefinir Palavra-passe Agora
        </a>
        
        <div class="text-center">
          <a href="{{ url_for('login') }}" class="text-sm text-gray-600 hover:text-primary-600 font-medium transition-colors">
            <i class="fas fa-arrow-left mr-1"></i>Voltar ao login
          </a>
        </div>
      </div>

      <!-- Aviso de Desenvolvimento -->
      <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
        <div class="flex items-start">
          <i class="fas fa-exclamation-triangle text-yellow-600 mt-0.5 mr-3"></i>
          <div class="flex-1">
            <p class="text-xs text-yellow-800 font-medium mb-1">Modo Desenvolvimento Ativo</p>
            <p class="text-xs text-yellow-700">
              O envio de email via SMTP não está configurado. Em produção, este link seria enviado automaticamente por email.
            </p>
            <p class="text-xs text-yellow-700 mt-2">
              Para configurar SMTP, execute: <code class="bg-yellow-100 px-1 py-0.5 rounded">.\configure_smtp.ps1</code>
            </p>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<script>
function copyLink() {
  const input = document.getElementById('resetLink');
  input.select();
  input.setSelectionRange(0, 99999); // Mobile
  
  try {
    document.execCommand('copy');
    
    // Feedback visual
    const button = event.target.closest('button');
    const originalHTML = button.innerHTML;
    button.innerHTML = '<i class="fas fa-check mr-1"></i>Copiado!';
    button.classList.add('bg-green-600');
    button.classList.remove('bg-primary-600');
    
    setTimeout(() => {
      button.innerHTML = originalHTML;
      button.classList.remove('bg-green-600');
      button.classList.add('bg-primary-600');
    }, 2000);
  } catch (err) {
    alert('Erro ao copiar. Use Ctrl+C manualmente.');
  }
}
</script>
{% endblock %}
